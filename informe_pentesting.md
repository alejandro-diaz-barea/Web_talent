# Informe de Pentesting - Aplicación Web Talent

##  Introducción
Este informe detalla los hallazgos de seguridad en la aplicación **Web Talent**, identificando vulnerabilidades críticas que pueden comprometer la integridad, confidencialidad y disponibilidad del sistema. Se han evaluado los principales riesgos de seguridad web, incluyendo **inyección SQL, XSS, gestión de sesiones y autenticación insegura**.


##  Hallazgos de Seguridad

### 1️⃣ **Inyección SQL en `buscador.php`**
** Descripción:**  
Se identificó que el parámetro `name` en `buscador.php` es directamente insertado en la consulta SQL sin sanitización, permitiendo **inyección SQL**.

**Impacto:**  
- Un atacante podría extraer, modificar o eliminar datos de la base de datos.
- Posibilidad de escalación de privilegios si la base de datos permite ejecución de comandos.

**Evidencia:**
```php
$name = $_GET['name'];
$query = "SELECT playerid, name, team FROM players where name='$name' order by playerId desc";
```

**Solución:**  
 Implementar **consultas preparadas** para evitar inyecciones SQL:
```php
$stmt = $db->prepare("SELECT playerid, name, team FROM players WHERE name = :name ORDER BY playerId DESC");
$stmt->bindValue(':name', $_GET['name'], SQLITE3_TEXT);
$result = $stmt->execute();
```


### 2️⃣ **Cross-Site Scripting (XSS) en comentarios**
**Descripción:**  
Se detectó que el campo de comentarios en `show_comments.php` permite la inserción de código JavaScript sin sanitización.

**Impacto:**  
- Posibilidad de **robo de sesiones** mediante cookies (`document.cookie`).
- Manipulación de contenido o redirección a sitios maliciosos.

**Evidencia:**
```html
<script>alert('XSS')</script>
```
Resultado: **Ejecución del `alert()` en la página del usuario.**

**Solución:**  
 **Escapar los datos antes de mostrarlos en la web:**  
```php
echo htmlspecialchars($row['body']);
```
 **Implementar una política CSP estricta:**  
```http
Content-Security-Policy: default-src 'self'; script-src 'none';
```

---

### 3️⃣ **Gestión insegura de sesiones (`register.php`)**
** Descripción:**  
Se observó que los usuarios pueden acceder a `register.php` sin restricciones, lo que permite **registrarse sin autenticación previa**.

**Impacto:**  
- Un atacante podría **crear múltiples cuentas fraudulentas** y manipular el sistema.
- Se compromete la autenticación si el sistema depende de estos registros.

**Evidencia:**
```php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $query = "INSERT INTO users (username, password) VALUES ('$username', '$password')";
    $db->query($query);
}
```

**Solución:**  
 **Restringir el acceso solo a administradores:**  
```php
if (!isset($_SESSION['username']) || $_SESSION['role'] !== 'admin') {
    die("Acceso denegado.");
}
```
 **Deshabilitar el registro si no es necesario en producción.**


## Recomendaciones generales

🔹 **Uso de WAF (Firewall de Aplicaciones Web):** Implementar Cloudflare o ModSecurity para bloquear ataques de XSS y SQLi.  
🔹 **Forzar HTTPS:** Evitar tráfico en HTTP y aplicar `Strict-Transport-Security (HSTS)`.  
🔹 **Implementar Control de Accesos:** Limitar la ejecución de acciones críticas solo a usuarios autenticados y con permisos adecuados.  
🔹 **Auditoría de logs:** Registrar intentos de acceso fallidos y alertar ante patrones sospechosos.  
🔹 **Mejorar la gestión de sesiones:** Cookies con `HttpOnly`, `Secure`, `SameSite=Strict` y regeneración de ID de sesión tras el login.


📅 **Fecha del informe:** _<?= date("d/m/Y") ?>_  
📝 **Pentester:** _[Tu Nombre]_  


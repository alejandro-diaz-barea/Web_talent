# Informe de Pentesting - Aplicaci贸n Web Talent

##  Introducci贸n
Este informe detalla los hallazgos de seguridad en la aplicaci贸n **Web Talent**, identificando vulnerabilidades cr铆ticas que pueden comprometer la integridad, confidencialidad y disponibilidad del sistema. Se han evaluado los principales riesgos de seguridad web, incluyendo **inyecci贸n SQL, XSS, gesti贸n de sesiones y autenticaci贸n insegura**.


##  Hallazgos de Seguridad

### 1锔 **Inyecci贸n SQL en `buscador.php`**
** Descripci贸n:**  
Se identific贸 que el par谩metro `name` en `buscador.php` es directamente insertado en la consulta SQL sin sanitizaci贸n, permitiendo **inyecci贸n SQL**.

**Impacto:**  
- Un atacante podr铆a extraer, modificar o eliminar datos de la base de datos.
- Posibilidad de escalaci贸n de privilegios si la base de datos permite ejecuci贸n de comandos.

**Evidencia:**
```php
$name = $_GET['name'];
$query = "SELECT playerid, name, team FROM players where name='$name' order by playerId desc";
```

**Soluci贸n:**  
 Implementar **consultas preparadas** para evitar inyecciones SQL:
```php
$stmt = $db->prepare("SELECT playerid, name, team FROM players WHERE name = :name ORDER BY playerId DESC");
$stmt->bindValue(':name', $_GET['name'], SQLITE3_TEXT);
$result = $stmt->execute();
```


### 2锔 **Cross-Site Scripting (XSS) en comentarios**
**Descripci贸n:**  
Se detect贸 que el campo de comentarios en `show_comments.php` permite la inserci贸n de c贸digo JavaScript sin sanitizaci贸n.

**Impacto:**  
- Posibilidad de **robo de sesiones** mediante cookies (`document.cookie`).
- Manipulaci贸n de contenido o redirecci贸n a sitios maliciosos.

**Evidencia:**
```html
<script>alert('XSS')</script>
```
Resultado: **Ejecuci贸n del `alert()` en la p谩gina del usuario.**

**Soluci贸n:**  
 **Escapar los datos antes de mostrarlos en la web:**  
```php
echo htmlspecialchars($row['body']);
```
 **Implementar una pol铆tica CSP estricta:**  
```http
Content-Security-Policy: default-src 'self'; script-src 'none';
```

---

### 3锔 **Gesti贸n insegura de sesiones (`register.php`)**
** Descripci贸n:**  
Se observ贸 que los usuarios pueden acceder a `register.php` sin restricciones, lo que permite **registrarse sin autenticaci贸n previa**.

**Impacto:**  
- Un atacante podr铆a **crear m煤ltiples cuentas fraudulentas** y manipular el sistema.
- Se compromete la autenticaci贸n si el sistema depende de estos registros.

**Evidencia:**
```php
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $query = "INSERT INTO users (username, password) VALUES ('$username', '$password')";
    $db->query($query);
}
```

**Soluci贸n:**  
 **Restringir el acceso solo a administradores:**  
```php
if (!isset($_SESSION['username']) || $_SESSION['role'] !== 'admin') {
    die("Acceso denegado.");
}
```
 **Deshabilitar el registro si no es necesario en producci贸n.**


## Recomendaciones generales

 **Uso de WAF (Firewall de Aplicaciones Web):** Implementar Cloudflare o ModSecurity para bloquear ataques de XSS y SQLi.  
 **Forzar HTTPS:** Evitar tr谩fico en HTTP y aplicar `Strict-Transport-Security (HSTS)`.  
 **Implementar Control de Accesos:** Limitar la ejecuci贸n de acciones cr铆ticas solo a usuarios autenticados y con permisos adecuados.  
 **Auditor铆a de logs:** Registrar intentos de acceso fallidos y alertar ante patrones sospechosos.  
 **Mejorar la gesti贸n de sesiones:** Cookies con `HttpOnly`, `Secure`, `SameSite=Strict` y regeneraci贸n de ID de sesi贸n tras el login.


 **Fecha del informe:** _<?= date("d/m/Y") ?>_  
 **Pentester:** _[Tu Nombre]_  

